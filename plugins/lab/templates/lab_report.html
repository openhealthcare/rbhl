{% extends 'static_base.html' %}
{% load rbhl_panels %}


{% block title %}
<style>
  @media print{
    @page {
      size: auto;
      margin-left: 3cm;
      margin-right: 3cm
    }
  }
</style>
Lab report
(
  <a href="/#/patient/{{ object.patient_id }}">
  {% if object.patient.demographics.name %}
  {{ object.patient.demographics.name }}
  {% else %}
  Lab patient
  {% endif %}
  </a>
  {% if object.blood_number %}
  -
  <a href="/pathway/#/bloods/{{ object.patient_id }}/{{ object.patient.episode_set.last.id }}?id={{ object.id }}">
    {{ object.blood_number }}
  </a>
  {% endif %}


)
{% endblock %}

{% block page_content %}
<div class="lab-report">

  {% for field, value in data.items %}
  {% if forloop.counter0|divisibleby:2 %}
  <div class="row content-offset-10">
  {% endif %}
  <div class="col-xs-6">
    <div class="row">
      <div class="col-xs-5 col-md-3">
        {{ field }}:
      </div>
      <div class="col-xs-7 col-md-9">
        {{ value }}
      </div>
    </div>
  </div>
  {% if not forloop.counter0|divisibleby:2 %}
  </div>
  {% endif %}
  {% endfor %}
  {% if comments %}
  <div class="row content-offset-10">
    <div class="col-xs-6">
      <div class="row">
        <div class="col-xs-5 col-md-3">
        Comments:
        </div>
        <div class="col-xs-7 col-md-9">
        {{ object.comment|linebreaks }}
        </div>
      </div>
    </div>
  </div>
  {% endif %}
  <div class="row content-offset">
    <div class="col-md-9 col-xs-12">
      <table class="table">
        <thead>
          <tr>
            <th>Allergen</th>
            <th>Result</th>
          </tr>
        </thead>
        <tbody>
          {% for result in object.bloodresult_set.all %}
          {# For int/float fields make sure they show if they are 0 #}
          {% if result.kul or result.rast is not None or result.rast_score is not None or result.precipitin or result.igg is not None %}
          <tr>
            <td>
              {{ result.allergen }}
              {% if result.antigenno %}
              ({{ result.antigenno }})
              {% endif %}
              {% if result.comment %}
              - {{ result.comment }}
              {% endif %}
            </td>
            <td>
              {% if result.kul %}
                {{ result.kul }} KU/L
              {% endif %}
              {% if result.rast is not None  %}
                {{ result.rast }} %B
              {% endif %}
              {% if result.rast_score is not None  %}
                {{ result.rast_score }}
              {% endif %}
              {% if result.precipitin %}
                {{ result.precipitin }}
              {% endif %}
              {% if result.igg is not None  %}
                {{ result.igg }} mg/L
              {% endif %}
            </td>
          </tr>
          {% endif %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

{% endblock %}